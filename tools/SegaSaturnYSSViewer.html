---
layout: post
tags: 
- tools
- segasaturn
- saturn
title: Sega Saturn Save State Visualizer (.yss)
image: /public/N64/N64 ROM Visualizer.jpg
permalink: /yssVisualizer
recommend: segasaturn
editlink: ../tools/SegaSaturnYSSViewer.html
---
{% include file-parser.html format="YSS" %}

<style>
  .CART_SECTION {
    color:green;
  }
  .CS2_SECTION {
    color:yellow;
  }
  .Master_SH2_CPU_SECTION {
    color:purple;
  }
  .Slave_SH2_CPU_SECTION {
    color:pink;
  }
  .SOUND_SCSP_SECTION {
    color:violet;
  }
  .SMPC_SECTION {
    color:olive;
  }
  .GRAPHICS_VDP1_SECTION {
    color:blue;
  }
  .GRAPHICS_VDP2_SECTION {
    color:orange;
  }
  .OTHER_SECTION {
    color:brown;
  }
  
  .SECTION_NAME:before {
    content: '\00000A';
  }
</style>

<script>
var _window$binary_unpars = window["binary_unparser"],Parser = _window$binary_unpars.Parser,FileUnparser = _window$binary_unpars.FileUnparser,ReactUnparser = _window$binary_unpars.ReactUnparser,Buffer = _window$binary_unpars.Buffer;

var yssVideoHeader = new Parser.Parser()
.endianess("little")
.uint32("VIDEO_FRAME_COUNT")
.uint32("VIDEO_POSITION")

var yssSectionHeader = new Parser.Parser()
.endianess("little")
.string("SECTION_NAME", { length: 4 })
.uint32("SECTION_VERSION")
.uint32("SECTION_SIZE");

var yssVDP2Registers =   new Parser.Parser()
  .endianess("little")
  .array("VDP2_REGS", {
    type: "uint8",
    length: 288 })
  
  

var yssVDP2Section = new Parser.Parser()
  .endianess("little")
  .nest("HEADER", { type: yssSectionHeader})
  .nest("VDP2_Registers", { type: yssVDP2Registers})
  .array("VDP2_RAM", {
    type: "uint8",
    length: 0x80000 
  })
  .array("VDP2_COLOR_RAM", {
    type: "uint8",
    length: 0x80000 
  })
  .int32("COLOR_MODE");

var yssOtherSection = new Parser.Parser()
.endianess("little")
.nest("OTHER_SECTION_HEADER", { type: yssSectionHeader})
.array("BUP_RAM", {
  type: "uint8",
  length: 0x10000 })
.array("HIGH_WORK_RAM", {
  type: "uint8",
  length: 0x100000 })
.array("LOW_WORK_RAM", {
  type: "uint8",
  length: 0x100000 })
.int32("DECILINE_COUNT")
.int32("LINE_COUNT")
.int32("VBLANK_LINE_COUNT")
.int32("MAX_LINE_COUNT")
.int32("TEMP1")
.int32("TEMP2")
.uint32("TEMP3")
.int32("CUR_SH2_FREQ_TYPE")
.int32("IS_PAL")
.int32("OUTPUT_WIDTH")
.int32("OUTPUT_HEIGHT")
.int32("UNKNOWN_")
;
// CurSH2FreqType
//   IsPal



var yssSectionDefault = new Parser.Parser()
.endianess("little")
.string("SECTION_NAME", { length: 4 })
.uint32("SECTION_VERSION")
.uint32("SECTION_SIZE")
// .skip(function() { return this.SECTION_SIZE } }));
.array("SECTION_CONTENT", {
  type: "uint8",
  length: function() { return this.SECTION_SIZE } });
  
// YSS File Parser
var yssHeader = new Parser.Parser()
.endianess("little")
.string("YSS_SIGNATURE", { length: 3 })
.uint8("HEADER_ENDIAN", { assertWithoutErroring: 0x01 })
.uint32("HEADER_VERSION", { assertWithoutErroring: 0x02 })
.uint32("HEADER_SIZE")
// IF HEADER VERSION == 2 THEN READ VIDEO
.choice("HEADER_VIDEO", {
  tag: "HEADER_VERSION",
  choices: {
    2: yssVideoHeader
  },
  defaultChoice: new Parser.Parser()
})
.nest("CART_SECTION", { type: yssSectionDefault})
.nest("CS2_SECTION", { type: yssSectionDefault})
.nest("Master_SH2_CPU_SECTION", { type: yssSectionDefault})
.nest("Slave_SH2_CPU_SECTION", { type: yssSectionDefault})
.nest("SOUND_SCSP_SECTION", { type: yssSectionDefault})
.nest("SCU_SECTION", { type: yssSectionDefault})
.nest("SMPC_SECTION", { type: yssSectionDefault})
.nest("GRAPHICS_VDP1_SECTION", { type: yssSectionDefault})
.nest("GRAPHICS_VDP2_SECTION", { type: yssVDP2Section})
.nest("OTHER_SECTION", { type: yssOtherSection})
;

var yssFileUnParser = new ReactUnparser(yssHeader);


var draghint = document.getElementById('draghint');
window.addEventListener('drop', function (event) {
  event.preventDefault();
  draghint.classList.remove('hover');
  for (var i = 0; i < event.dataTransfer.files.length; i++) {
    var file = event.dataTransfer.files[i];
    var c = document.createElement('canvas');
    c.id = 'v64' + i;
    $('#v64').append(c);
    console.log(file, i, c);
    parseFile(file, yssHeader, yssFileUnParser, false);
  }
  return false;
});
window.addEventListener('dragover', function (event) {
  event.preventDefault();
  draghint.classList.add('hover');
  return false;
});
window.addEventListener('dragleave', function (event) {
  event.preventDefault();
  draghint.classList.remove('hover');
  return false;
});
window.addEventListener('focus', function () {
  return draghint.classList.remove('hover');
});
  </script>
